\name{fitBySCE}
\alias{fitBySCE}
\title{
  Fit a hydromad model using the SCE (Shuffled Complex Evolution) algorithm.
}
\description{
  Fit a hydromad model using the SCE (Shuffled Complex Evolution) algorithm.
}
\usage{
fitBySCE(MODEL, 
         objective = hydromad.getOption("objective"),
         control = hydromad.getOption("sce.control"))
}
\arguments{
  \item{MODEL}{
    a model specification created by \code{\link{hydromad}}. It should
    not be fully specified, i.e one or more parameters should be defined
    by \emph{ranges} of values rather than exact values.
  }
  \item{objective}{
    objective function to minimise, given as a \code{formula} involving
    \code{Q}, \code{X} and/or \code{U}. See \code{\link{objFunVal}}.
  }
  \item{control}{
    settings for the SCE algorithm. See \code{\link{SCEoptim}}.
  }
  \item{vcov}{
    if \code{vcov = TRUE}, the parameter variance-covariance matrix
    will be estimated from the final population.
    It can be extract using \code{\link{vcov}}.
  }
}
\value{
  the best model from those sampled, according to the given
  \code{objective} function. The result from \code{\link{SCEoptim}} is
  stored as item \code{fit.result}.
}
\author{
  Felix Andrews \email{felix@nfrac.org}
}
\seealso{
  \code{\link{SCEoptim}},
  \code{\link{objFunVal}}
}
\examples{
data(Cotter)
x <- Cotter[1:1000]

## IHACRES CWI model with power law unit hydrograph
modx <- hydromad(x, sma = "cwi", routing = "powuh")
modx

tmp <- fitBySCE(modx, control = list(returnpop = TRUE))
str(tmp$fit.result)

iterfits <- t(tmp$fit.result$POP.FIT.ALL)
xyplot(as.ts(apply(iterfits, 1, min)), type = "b",
       xlab = "iterations", ylab = "objective function value") +
layer(panel.xyplot(1:nrow(iterfits), iterfits, type = c("p","a"), lwd = 2))
}
\keyword{ optimization }
